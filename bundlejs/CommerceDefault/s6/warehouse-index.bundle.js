"use strict";function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,n,a,i,l,o,s,r,d,c,u){this.InputElement=a,this.AcceptExtention=a.accept.split(","),this.PreviewBoxElement=l,this.CurentImageBox=i,this.Form=o,this.UniqueControlName=c?"CurentFilePaths":"NewFiles"+c,this.MaxFile=s||2,this.MaxFileSize=u||5242880,this.InputChangeCallBack=void 0!==r?r:null,this.InputElement.addEventListener("change",this.InputChange),(this.InputElement.fileUpload=this).FileReader=new FileReader,this.IsCreateInputName=d||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=n||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var t=this,e=0;e<this.CurentFiles.length;e++){var n=this.CurentFiles[e],a=this.CurentPreviewImages[e],i=document.createElement("div");i.className="col-3 gutter-10 _p-item text-center";var l=document.createElement("figure");l.className="_max-height-200 relative hover-children-show";var o=document.createElement("button");o.className="absolute hide tablet-show -border width-100 height-100 _fill-silver-opacity text-strong",o.innerText="CLICK ĐỂ XÓA",o.type="button",o.dataset.file=n,o.dataset.notClose="I",o.addEventListener("click",function(e){t.RemoveCurentFile(e,t.InputElement)});var s,r,d=n.substring(n.lastIndexOf("/")+1),c=d.substring(d.indexOf(".")+1);if(("."+c).match(".jpg,.png,.svg,.gif,.jfif,.webp,.csv".replace(new RegExp(",","g"),"|"))?s="<img class='_max-width-100-percent'   onerror='this.src=\"/images/shared/no-image.svg\"'   src='"+t.HostS3+"/"+a+"' alt='"+d+"' data-file='"+d+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+d+"</figcaption>":(s="<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+c+"</tspan></text></svg>",(r=document.createElement("div")).innerHTML="<div class='row text-center _text-ellipsis'><a target='_blank' href='"+t.HostCdn+"/"+a+"'>"+d+"</a></div>"),t.IsCreateInputName)s+="<input type='text' class='_hidden'    name='"+t.UniqueControlName+"' value="+n+(t.Form?" form='"+t.Form.id+"'":"")+"></input>";l.innerHTML=s,l.insertBefore(o,l.childNodes[0]),i.appendChild(l),r&&i.appendChild(r),t.CurentImageBox.appendChild(i)}},this.InputChange=function(e){var o=e.target.fileUpload,t=e.target.files,n=Array.prototype.slice.call(t);o.PreviewBoxElement.innerHTML="",o.StoredFiles=[];for(var a=0;a<n.length;a++){var i=n[a];if(i.size>o.MaxFileSize)Site.NotifyFormFailed("Lỗi","File không được lớn hơn "+o.MaxFileSize/1048576+" mb");else if(o.StoredFiles.push(i),o.PreviewBoxElement===o.CurentImageBox&&(o.CurentFiles=[],o.CurentImageBox.innerHTML=""),o.StoredFiles.length+o.CurentFiles.length<=o.MaxFile){var l=new FileReader;l.onload=function(e){var t=event.target,n=document.createElement("div");n.className="gutter-10 _p-item";var a=document.createElement("figure");a.className="_max-height-200 relative hover-children-show";var i,l=document.createElement("button");(l.className="absolute hide -border width-100 height-100 _fill-silver-opacity text-strong",l.type="button",l.innerText="CLICK ĐỂ XÓA",l.dataset.file=t.name,l.dataset.notClose="I",l.addEventListener("click",function(e){o.RemoveFile(e,o.InputElement)}),t.fileType.match("image.*"))?i="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+t.name+"' data-file='"+t.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+t.size%1e3+" kb) "+t.name+"</figcaption>":i="<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+t.name.substring(t.name.indexOf(".")+1)+"</tspan></text></svg><figcaption class='padding-5 text-center _text-ellipsis'>("+t.size%1e3+" kb) "+t.name+"</figcaption>";o.IsCreateInputName&&(i+="<input type='text' class='_hidden' name='"+o.UniqueControlName+"[]' value="+t.name+(o.Form?" form='"+o.Form.id+"'":"")+"></input>");a.innerHTML=i,a.insertBefore(l,a.childNodes[0]),n.appendChild(a),o.PreviewBoxElement.appendChild(n)},l.size=i.size,l.fileType=i.type,l.name=i.name,l.readAsDataURL(i)}}o.InputChangeCallBack&&o.InputChangeCallBack(o.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,n=0;n<this.CurentFiles.length;n++)if(this.CurentFiles[n]===t){this.CurentFiles.splice(n,1);break}Site.FindParent(e.target,"_p-item").remove()},this.RemoveFile=function(e,t){for(var n=e.target.dataset.file,a=0;a<this.StoredFiles.length;a++)if(this.StoredFiles[a].name===n){this.StoredFiles.splice(a,1);break}Site.FindParent(e.target,"_p-item").remove(),Site.ClearInputFile(t)},this.Init=function(e,t,n,a,i,l,o,s,r,d,c,u){var h=document.querySelector(a),m=document.querySelector(l),g=document.querySelector(i),p=document.querySelector(o);null!=h&&null!=m||console.warn(a+" or "+m+": NULL"),this.Extend(e,t,n,h,g,m,p,s,r,d,c,u)}}var map,sPlaceLevel1,sPlaceLevel2,sPlaceLevel3,txtVnLocationId,btnReloadListWarehouse,btnGetCurentPlace,txtLatitude,txtLongitude,infoWindow,markers=[];function initWarehouseList(){txtVnLocationId=document.querySelector("#frmLazyLoadWareHouse [name='VnLocationId']"),btnReloadListWarehouse=document.getElementById("btnReloadListWarehouse"),btnGetCurentPlace=document.getElementById("btnGetCurentPlace"),txtLatitude=document.getElementById("txtLatitude"),txtLongitude=document.getElementById("txtLongitude"),btnGetCurentPlace.addEventListener("click",function(e){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};(infoWindow=new google.maps.InfoWindow).setPosition(t),infoWindow.setContent("Vị trí của bạn"),infoWindow.open(map),map.setCenter(t),txtLatitude.value=e.coords.latitude,txtLongitude.value=e.coords.longitude,btnReloadListWarehouse.click()})}),sPlaceLevel1=document.getElementById("sPlaceLevel1"),sPlaceLevel2=document.getElementById("sPlaceLevel2"),sPlaceLevel3=document.getElementById("sPlaceLevel3"),sPlaceLevel1.addEventListener("change",function(e){var t=e.currentTarget.value,n=sPlaceLevel2.querySelectorAll("option");n[0].selected=!0;for(var a=1;a<n.length;a++)n[a].setAttribute("disabled","disabled");if(t){for(a=1;a<n.length;a++)n[a].dataset.parentId===t&&n[a].removeAttribute("disabled");console.log("sPlaceLevel1:"+t),lazyLoadWarehouse(t)}else lazyLoadWarehouse()}),sPlaceLevel2.addEventListener("change",function(e){var t=e.currentTarget.value,n=sPlaceLevel3.querySelectorAll("option");n[0].selected=!0;for(var a=1;a<n.length;a++)n[a].setAttribute("disabled","disabled");if(t){for(a=1;a<n.length;a++)n[a].dataset.parentId===t&&n[a].removeAttribute("disabled");console.log("sPlaceLevel2:"+t),lazyLoadWarehouse(t)}else lazyLoadWarehouse()}),sPlaceLevel3.addEventListener("change",function(e){var t=e.currentTarget.value;t?(console.log("sPlaceLevel3:"+t),lazyLoadWarehouse(t)):lazyLoadWarehouse()})}function lazyLoadWarehouse(e){txtVnLocationId.value=e||(sPlaceLevel3.value?sPlaceLevel3.value:sPlaceLevel2.value?sPlaceLevel2.value:sPlaceLevel1.value?sPlaceLevel1.value:""),btnReloadListWarehouse.click()}function initMap(){var e=document.getElementById("mapContainer"),t={lat:+e.dataset.lat,lng:+e.dataset.lng};map=new google.maps.Map(document.getElementById("mapContainer"),{center:t,zoom:5,disableDefaultUI:!0,options:{gestureHandling:"greedy"}}),loadMarker()}function lazyloadComplete(){loadMarker()}function loadMarker(){clearMarkers();for(var e=document.querySelectorAll("[name='SelectedWarehouse']"),t=0;t<e.length;t++)e[t].addEventListener("change",function(e){var t={lat:+e.target.dataset.lat,lng:+e.target.dataset.lng};map.setCenter(t),map.setZoom(18)});for(var n=new google.maps.LatLngBounds,a=0;a<e.length;a++){var i={lat:+e[a].dataset.lat,lng:+e[a].dataset.lng},l=new google.maps.Marker({map:map,position:i,title:e[a].dataset.title});n.extend(i),markers.push(l)}map.fitBounds(n),18<map.zoom&&map.setZoom(18)}function clearMarkers(){for(var e=0;e<markers.length;e++)markers[e].setMap(null)}document.addEventListener("DOMContentLoaded",function(){initWarehouseList()});