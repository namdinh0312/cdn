"use strict";var btnSearchProductName,galleryThumbs,galleryTop;function processAnonymousUser(){for(var e=document.querySelectorAll("[rating-id] canvas"),t=0;t<e.length;t++){var i=e[t],a=i.dataset.userName.split(" "),n=2<a.length?a[0].charAt(0).toUpperCase()+a[1].charAt(0).toUpperCase():a[0].charAt(0).toUpperCase(),l=i.getContext("2d"),r=i.width,o=i.height;window.devicePixelRatio&&(i.setAttribute("width",r*window.devicePixelRatio),i.setAttribute("height",o*window.devicePixelRatio),i.style.width=r+"px",i.style.height=o+"px",l.scale(window.devicePixelRatio,window.devicePixelRatio)),l.fillStyle=stringToHslColor(n,30,80),l.fillRect(0,0,i.width,i.height),l.font=o/2+"px Arial",l.textAlign="center",l.fillStyle="#FFF",l.fillText(n,r/2,o/1.5)}}function stringToHslColor(e,t,i){for(var a=0,n=0;n<e.length;n++)a=e.charCodeAt(n)+((a<<5)-a);return"hsl("+a%360+", "+t+"%, "+i+"%)"}function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,i,a,n,l,r,o,s,c,d,h){this.InputElement=a,this.AcceptExtention=a.accept.split(","),this.PreviewBoxElement=l,this.CurentImageBox=n,this.Form=r,this.UniqueControlName=d?"CurentFilePaths":"NewFiles"+d,this.MaxFile=o||2,this.MaxFileSize=h||5242880,this.InputChangeCallBack=void 0!==s?s:null,this.InputElement.addEventListener("change",this.InputChange),(this.InputElement.fileUpload=this).FileReader=new FileReader,this.IsCreateInputName=c||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=i||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var t=this,e=0;e<this.CurentFiles.length;e++){var i=this.CurentFiles[e],a=this.CurentPreviewImages[e],n=document.createElement("div");n.className="col-3 gutter-10 _p-item text-center";var l=document.createElement("figure");l.className="_max-height-200 relative hover-children-show";var r=document.createElement("button");r.className="absolute hide tablet-show -border width-100 height-100 _fill-silver-opacity text-strong",r.innerText="CLICK ĐỂ XÓA",r.type="button",r.dataset.file=i,r.dataset.notClose="I",r.addEventListener("click",function(e){t.RemoveCurentFile(e,t.InputElement)});var o,s,c=i.substring(i.lastIndexOf("/")+1),d=c.substring(c.indexOf(".")+1);if(("."+d).match(".jpg,.png,.svg,.gif,.jfif,.webp,.csv".replace(new RegExp(",","g"),"|"))?o="<img class='_max-width-100-percent'   onerror='this.src=\"/images/shared/no-image.svg\"'   src='"+t.HostS3+"/"+a+"' alt='"+c+"' data-file='"+c+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+c+"</figcaption>":(o="<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+d+"</tspan></text></svg>",(s=document.createElement("div")).innerHTML="<div class='row text-center _text-ellipsis'><a target='_blank' href='"+t.HostCdn+"/"+a+"'>"+c+"</a></div>"),t.IsCreateInputName)o+="<input type='text' class='_hidden'    name='"+t.UniqueControlName+"' value="+i+(t.Form?" form='"+t.Form.id+"'":"")+"></input>";l.innerHTML=o,l.insertBefore(r,l.childNodes[0]),n.appendChild(l),s&&n.appendChild(s),t.CurentImageBox.appendChild(n)}},this.InputChange=function(e){var r=e.target.fileUpload,t=e.target.files,i=Array.prototype.slice.call(t);r.PreviewBoxElement.innerHTML="",r.StoredFiles=[];for(var a=0;a<i.length;a++){var n=i[a];if(n.size>r.MaxFileSize)Site.NotifyFormFailed("Lỗi","File không được lớn hơn "+r.MaxFileSize/1048576+" mb");else if(r.StoredFiles.push(n),r.PreviewBoxElement===r.CurentImageBox&&(r.CurentFiles=[],r.CurentImageBox.innerHTML=""),r.StoredFiles.length+r.CurentFiles.length<=r.MaxFile){var l=new FileReader;l.onload=function(e){var t=event.target,i=document.createElement("div");i.className="gutter-10 _p-item";var a=document.createElement("figure");a.className="_max-height-200 relative hover-children-show";var n,l=document.createElement("button");(l.className="absolute hide -border width-100 height-100 _fill-silver-opacity text-strong",l.type="button",l.innerText="CLICK ĐỂ XÓA",l.dataset.file=t.name,l.dataset.notClose="I",l.addEventListener("click",function(e){r.RemoveFile(e,r.InputElement)}),t.fileType.match("image.*"))?n="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+t.name+"' data-file='"+t.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+t.size%1e3+" kb) "+t.name+"</figcaption>":n="<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+t.name.substring(t.name.indexOf(".")+1)+"</tspan></text></svg><figcaption class='padding-5 text-center _text-ellipsis'>("+t.size%1e3+" kb) "+t.name+"</figcaption>";r.IsCreateInputName&&(n+="<input type='text' class='_hidden' name='"+r.UniqueControlName+"[]' value="+t.name+(r.Form?" form='"+r.Form.id+"'":"")+"></input>");a.innerHTML=n,a.insertBefore(l,a.childNodes[0]),i.appendChild(a),r.PreviewBoxElement.appendChild(i)},l.size=n.size,l.fileType=n.type,l.name=n.name,l.readAsDataURL(n)}}r.InputChangeCallBack&&r.InputChangeCallBack(r.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,i=0;i<this.CurentFiles.length;i++)if(this.CurentFiles[i]===t){this.CurentFiles.splice(i,1);break}Site.FindParent(e.target,"_p-item").remove()},this.RemoveFile=function(e,t){for(var i=e.target.dataset.file,a=0;a<this.StoredFiles.length;a++)if(this.StoredFiles[a].name===i){this.StoredFiles.splice(a,1);break}Site.FindParent(e.target,"_p-item").remove(),Site.ClearInputFile(t)},this.Init=function(e,t,i,a,n,l,r,o,s,c,d,h){var u=document.querySelector(a),m=document.querySelector(l),g=document.querySelector(n),p=document.querySelector(r);null!=u&&null!=m||console.warn(a+" or "+m+": NULL"),this.Extend(e,t,i,u,g,m,p,o,s,c,d,h)}}function loadUserViewedProduct(){var e=LocalStorageHelper.Get(LocalStorageNamesEnum.ViewProductClassificationIds);if(e&&e.length){for(var t=document.querySelector("#productViewedContainer"),i=0;i<e.length;i++){var a=e[i],n='<a href="[ProductUrl]" title="[ProductName]" class="_image-wrap -tablet-margin-bottom rounded-4 border-1 solid border-silver padding-5"> <img alt="[ProductName]" class="b-lazy" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="[ProductThumnailUrl]"></a>';n=(n=(n=n.replace(/\[ProductUrl\]/g,a.ProductUrl)).replace(/\[ProductName\]/g,a.ProductName)).replace(/\[ProductThumnailUrl\]/g,a.ProductThumnailUrl),a=Site.HtmlToElement(n),t.appendChild(a[0])}Site.BeLazyRevalidate()}}function SlideToProductClass(e){for(var t="swiper-slide-"+e,i=1;i<galleryTop.slides.length;i++)if(galleryTop.slides[i].classList.contains(t)){galleryTop.slideTo(i);break}}function LoadSwiperDefault(){galleryTop=new Swiper(".gallery-top",{spaceBetween:20,preloadImages:!0,centeredSlides:!0,lazy:!0,pagination:".swiper-pagination",paginationType:"fraction",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});var e=document.querySelector(".gallery-thumbs");if(e){if((galleryThumbs=new Swiper(".gallery-thumbs",{spaceBetween:20,centeredSlides:!0,slidesPerView:e.dataset.itemShow||4,touchRatio:.2,slideToClickedSlide:!0}))instanceof Array)for(var t=0;t<galleryThumbs.length;t++)0<galleryThumbs[t].imagesToLoad.length&&((galleryTop[t].controller.control=galleryThumbs)[t].controller.control=galleryTop);else(galleryTop.controller.control=galleryThumbs).controller.control=galleryTop;galleryThumbs.update()}}function _LoadImageSwipe(e,t){var i,a=document.querySelectorAll(".pswp")[0],n=document.querySelector(e),l=[],r=document.querySelectorAll(e+" .gallery-top .swiper-slide > [itemprop=contentUrl]"),o=document.querySelectorAll(e+" .gallery-top [itemprop=thumbnail] ._p-slide-image"),s=document.querySelector(e+" .swiper-slide-active");s||console.warn("ko có thumb dùng top gallery");for(var c=0;c<r.length;c++)(i={src:o[c].dataset.src||o[c].src||o[c].src,w:o[c].width,h:o[c].height,alt:o[c].alt,author:n.dataset.author}).msrc=s.getAttribute("data-src")||s.getAttribute("src"),i.el=s,i.title=n.dataset.seo,i.m={src:o[c].dataset.src||o[c].src||o[c].src,w:o[c].width,alt:o[c].alt,h:o[c].height,author:n.dataset.author},i.o={src:r[c].content,w:+r[c].parentElement.querySelector("[itemprop=width]").content,alt:o[c].alt,h:+r[c].parentElement.querySelector("[itemprop=height]").content,author:n.dataset.author},l.push(i);var d,h,u=new PhotoSwipe(a,PhotoSwipeUI_Default,l,{index:t,history:!1,focus:!1,hideAnimationDuration:0,getThumbBoundsFn:function(e){var t=l[e].el,i=window.pageYOffset||document.documentElement.scrollTop,a=t.getBoundingClientRect();return{x:a.left,y:a.top+i,w:a.width}},galleryUID:e}),m=!1,g=!0;u.listen("beforeResize",function(){var e=window.devicePixelRatio?window.devicePixelRatio:1;e=Math.min(e,2.5),1200<=(d=u.viewportSize.x*e)||!u.likelyTouchDevice&&800<d||1200<screen.width?m||(h=m=!0,console.log(screen.width+"use largeImage")):m&&(h=!(m=!1),console.log(screen.width+"not use largeImage")),h&&!g&&u.invalidateCurrItems(),g&&(g=!1),h=!1}),u.listen("gettingData",function(e,t){t.h=m?(t.src=t.o.src,t.alt=t.o.alt,t.w=t.o.w,t.o.h):(t.src=t.m.src,t.alt=t.o.alt,t.w=t.m.w,t.m.h)}),u.init()}function Quantity(){this.Extend=function(e,t,i,a){this.DownElement=e,this.UpElement=t,this.TargetElement=i,this.ValueChangeCallBack=a||function(){console.log("ValueChange don't have callback")},this.Process()},this.Process=function(){var t=this;this.UpElement.addEventListener("click",function(e){+t.TargetElement.value<+t.TargetElement.max&&(t.TargetElement.value=++t.TargetElement.value,t.ValueChangeCallBack&&t.ValueChangeCallBack())}),this.DownElement.addEventListener("click",function(e){+t.TargetElement.value>+t.TargetElement.min&&(t.TargetElement.value=--t.TargetElement.value,t.ValueChangeCallBack&&t.ValueChangeCallBack())}),this.TargetElement.addEventListener("keyup",function(e){+t.TargetElement.value>+t.TargetElement.max?t.TargetElement.value=+t.TargetElement.max:+t.TargetElement.value<+t.TargetElement.min&&(t.TargetElement.value=+t.TargetElement.min),t.ValueChangeCallBack&&t.ValueChangeCallBack()}),this.TargetElement.addEventListener("change",function(e){t.ValueChangeCallBack&&t.ValueChangeCallBack()})},this.Init=function(e,t){var i=e.querySelector("[data-minus]"),a=e.querySelector("[data-plus]"),n=e.querySelector("input[type='number']");this.Extend(i,a,n,t)}}document.addEventListener("DOMContentLoaded",function(){}),document.addEventListener("DOMContentLoaded",function(){loadUserViewedProduct()}),document.addEventListener("DOMContentLoaded",function(e){LoadSwiperDefault(),document.querySelector("._p-show-photowipe").addEventListener("click",function(e){var t=Array.from(galleryTop.slides).findIndex(function(e){return e.classList.contains("swiper-slide-active")})||galleryTop.activeIndex;_LoadImageSwipe(e.target.dataset.selector,t)})});