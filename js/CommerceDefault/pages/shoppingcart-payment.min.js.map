{"version":3,"sources":["wwwroot/js/CommerceDefault/pages/shoppingcart-payment.js"],"names":["myList","txtPhone","txtAddress","txtId","txtFullName","phoneNumberCleave","btnReloadShopingCartcartDetail","txtCode","txtDiscountcartDetail","txtDiscountCode","btnSubmitLoadDiscountCode","frmShipInfo","btnSearchWard","txtVnLocationName","txtVnLocationId","spanDataShipAddress","showAnimation","initPayment","document","getElementById","addEventListener","e","updateRealAddress","updateVnLocation","querySelector","uploadCart","target","value","processListItemShopingCartcartDetail","codeStr","length","click","loadCleave","mobileElement","Cleave","numericOnly","delimiters","blocks","loadAutoComplete","Awesomplete","filter","text","input","FILTER_CONTAINS","match","item","ITEM","replace","before","this","split","event","id","i","options","opt","dataset","phone","address","console","log","innerHTML","trim","loadLocationAutoComplete","$","autocomplete","appendTo","serviceUrl","deferRequestBy","minChars","noCache","onSelect","suggestion","data","showNoSuggestionNotice","noSuggestionNotice","formatResult","currentValue","level","lookupFilter","originalQuery","queryLowerCase","RegExp","Autocomplete","utils","escapeRegExChars","test","onSearchStart","query","Site","AddClassElement","onSearchComplete","suggestions","RemoveClassElement","curentVnLocationId","vnLocationCartDetailId","totalDetailElement","AjaxRequest","SendRequestGetJson","vnLocationId","sumdiscount","sumReal","totalWeight","weight","v","responseObject","JSON","parse","messageEle","suggestMessageEle","delShipPriceEle","shipPriceEle","delTotalEle","totalEle","innerText","message","suggestMessage","shipFee","normalShipPrice","maxSupportNormalShipPrice","shipDiscountPercent","parentNode","classList","add","WNumbHelper","GetFrNumber","summoney","sumTemp"],"mappings":"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","file":"shoppingcart-payment.min.js","sourcesContent":["\"use strict\";\n\nvar myList, txtPhone, txtAddress, txtId, txtFullName, phoneNumberCleave, btnReloadShopingCartcartDetail, txtCode, txtDiscountcartDetail;\nvar txtDiscountCode, btnSubmitLoadDiscountCode, frmShipInfo;\nvar btnSearchWard, txtVnLocationName, txtVnLocationId, spanDataShipAddress;\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  initPayment();\n  loadCleave();\n  loadAutoComplete();\n  loadLocationAutoComplete();\n  btnReloadShopingCartcartDetail = document.getElementById(\"btnReloadShopingCartcartDetail\");\n  btnReloadShopingCartcartDetail.click(); //frmShipInfo = document.querySelector(\"#frmShipInfo button\");\n  //if (!!frmShipInfo) {\n  //    frmShipInfo.addEventListener(\"click\", googleEcommerceChecking);\n  //}\n\n  updateRealAddress();\n}); //function googleEcommerceChecking() {\n//    var productItemElements = document.querySelectorAll(\"._id-cartcartDetail li\");\n//    for (var i = 0; i < productItemElements.length; i++) {\n//        var productId = productItemElements[i].querySelector(\"[data-product-id]\").dataset.productId;\n//        var productName = productItemElements[i].querySelector(\"[data-product-name]\").dataset.productName;\n//        var productVariant = productItemElements[i].querySelector(\"[data-product-class-name]\").dataset.productClassName;\n//        var productQuantity = productItemElements[i].querySelector(\"[data-quantity]\").dataset.quantity;\n//        var productPrice = productItemElements[i].querySelector(\"[data-price]\").dataset.price; \n//        EnhancedEcommerce.AddProduct(productId, productName, productVariant, '', '', productPrice, productQuantity);\n//    }\n//}\n\nfunction showAnimation() {\n  debugger;\n}\n\nfunction initPayment() {\n  myList = document.getElementById(\"mylist\");\n  txtPhone = document.getElementById(\"OrderViewModel_PhoneNumber\");\n  txtAddress = document.getElementById(\"OrderViewModel_Address\");\n  txtAddress.addEventListener(\"keyup\", function (e) {\n    updateRealAddress();\n  });\n  txtId = document.getElementById(\"OrderViewModel_ShippingAddressId\");\n  txtFullName = document.getElementById(\"OrderViewModel_FullName\");\n  btnSearchWard = document.getElementById(\"btnSearchWard\");\n  txtVnLocationName = document.getElementById(\"OrderViewModel_VnLocationName\");\n  txtVnLocationId = document.getElementById(\"OrderViewModel_VnLocationId\");\n  txtVnLocationName.addEventListener(\"keyup\", function (e) {\n    updateVnLocation();\n    updateRealAddress();\n  });\n  txtDiscountCode = document.getElementById(\"OrderViewModel_DiscountCode\");\n  spanDataShipAddress = document.querySelector(\"[data-ship-address]\");\n  txtDiscountCode.addEventListener(\"keyup\", function (e) {\n    uploadCart(e.target.value);\n  });\n}\n\nfunction processListItemShopingCartcartDetail() {}\n\nfunction uploadCart(codeStr) {\n  if (codeStr.length !== 8) {\n    return;\n  }\n\n  txtCode = document.getElementById(\"txtCode\");\n  txtDiscountcartDetail = document.getElementById(\"txtDiscountcartDetail\");\n  txtCode.value = codeStr;\n  txtDiscountcartDetail.value = codeStr;\n  btnReloadShopingCartcartDetail = document.getElementById(\"btnReloadShopingCartcartDetail\");\n  btnReloadShopingCartcartDetail.click();\n  btnSubmitLoadDiscountCode = document.getElementById(\"btnSubmitLoadDiscountCode\");\n  btnSubmitLoadDiscountCode.click();\n}\n\nfunction loadCleave() {\n  var mobileElement = document.getElementById('OrderViewModel_PhoneNumber');\n  phoneNumberCleave = new Cleave(mobileElement, {\n    numericOnly: true,\n    delimiters: [' ', ' ', ' '],\n    //prefix: '+84',\n    blocks: [4, 3, 5]\n  });\n}\n\nfunction loadAutoComplete() {\n  new Awesomplete('#OrderViewModel_FullName', {\n    filter: function filter(text, input) {\n      return Awesomplete.FILTER_CONTAINS(text, input.match(/[^\\|]*$/)[0]);\n    },\n    item: function item(text, input) {\n      return Awesomplete.ITEM(text, input.match(/[^\\|]*$/)[0]);\n    },\n    replace: function replace(text) {\n      var before = this.input.value.match(/^.+\\|\\s*|/)[0];\n      this.input.value = before + text.value.split('=')[1];\n    }\n  });\n  document.getElementById('OrderViewModel_FullName').addEventListener(\"awesomplete-selectcomplete\", function (event) {\n    var id = event.text.value.split(\"=\")[0];\n    event.target.value = event.text.value.split(\"=\")[1];\n\n    for (var i = 0; i < myList.options.length; i++) {\n      var opt = myList.options[i];\n\n      if (opt.id === id) {\n        txtPhone.value = opt.dataset.phone;\n        txtAddress.value = opt.dataset.address;\n        txtId.value = id;\n        console.log('autocomplet');\n        loadCleave();\n      }\n    }\n  });\n  document.getElementById('OrderViewModel_FullName').addEventListener(\"change\", function (event) {\n    console.log(\"change\");\n    loadCleave();\n  });\n}\n\nfunction updateRealAddress() {\n  spanDataShipAddress.innerHTML = !!txtAddress.value ? (txtAddress.value + \", \" + txtVnLocationName.value).trim() : txtVnLocationName.value;\n}\n\nfunction loadLocationAutoComplete() {\n  $('#OrderViewModel_VnLocationName').autocomplete({\n    appendTo: \"#suggestListLocationContainer\",\n    serviceUrl: '/shopingcart/searchlocationcomplete',\n    //lookup: theData,\n    deferRequestBy: 100,\n    minChars: 3,\n    noCache: true,\n    onSelect: function onSelect(suggestion) {\n      updateRealAddress(suggestion);\n      txtVnLocationId.value = suggestion.data.id;\n      updateVnLocation();\n    },\n    showNoSuggestionNotice: true,\n    noSuggestionNotice: 'Không tìm thấy địa chỉ',\n    formatResult: function formatResult(suggestion, currentValue) {\n      return \"<div class='padding-5  _cursor-poiter' level=\" + suggestion.data.level + \" data-vnlocation-id='\" + suggestion.data.id + \"'>\" + suggestion.value + \"</div>\";\n    },\n    lookupFilter: function lookupFilter(suggestion, originalQuery, queryLowerCase) {\n      var re = new RegExp('\\\\b' + $.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');\n      return re.test(suggestion.value);\n    },\n    onSearchStart: function onSearchStart(query) {\n      Site.AddClassElement(btnSearchWard, \"active\");\n      txtVnLocationId.value = \"\";\n    },\n    onSearchComplete: function onSearchComplete(query, suggestions) {\n      Site.RemoveClassElement(btnSearchWard, \"active\");\n    }\n  });\n}\n\nfunction updateVnLocation() {\n  var curentVnLocationId = txtVnLocationId.value;\n  var vnLocationCartDetailId = document.querySelector(\"#frmLazyLoadShopingCartcartDetail [name=vnLocationId]\");\n  var messageElement = document.querySelector(\"#frmLazyLoadShopingCartcartDetail [data-order-message]\");\n\n  if (!!curentVnLocationId) {\n    if (curentVnLocationId != vnLocationCartDetailId.value) {\n      vnLocationCartDetailId.value = curentVnLocationId;\n      var totalDetailElement = document.querySelector(\"[data-weight]\");\n      AjaxRequest.SendRequestGetJson(\"POST\", \"shopingcart/getshipfree\", {\n        \"vnLocationId\": curentVnLocationId,\n        \"sumdiscount\": totalDetailElement.dataset.sumReal,\n        \"totalWeight\": totalDetailElement.dataset.weight\n      }, function (e, v) {\n        var responseObject = JSON.parse(e);\n        var messageEle = document.getElementById(\"message\");\n        var suggestMessageEle = document.getElementById(\"suggestMessage\");\n        var delShipPriceEle = document.getElementById(\"delShipPrice\");\n        var shipPriceEle = document.getElementById(\"shipPrice\");\n        var delTotalEle = document.getElementById(\"delTotal\");\n        var totalEle = document.getElementById(\"total\");\n        messageEle.innerText = responseObject.message;\n        suggestMessageEle.innerText = responseObject.suggestMessage;\n        var shipFee = responseObject.normalShipPrice - (responseObject.maxSupportNormalShipPrice === 0 ? responseObject.normalShipPrice : responseObject.maxSupportNormalShipPrice) * responseObject.shipDiscountPercent / 100;\n        delShipPriceEle.parentNode.classList.add(responseObject.shipDiscountPercent > 0 ? \"visible\" : \"hidden\");\n        delShipPriceEle.innerText = WNumbHelper.GetFrNumber(responseObject.normalShipPrice);\n        shipPriceEle.innerText = WNumbHelper.GetFrNumber(shipFee);\n        var sumdiscount = +totalDetailElement.dataset.sumReal;\n        var summoney = +totalDetailElement.dataset.sumTemp;\n        delTotalEle.parentNode.classList.add(responseObject.shipDiscountPercent > 0 || sumdiscount !== summoney ? \"visible\" : \"hidden\");\n        delTotalEle.innerText = WNumbHelper.GetFrNumber(responseObject.normalShipPrice + summoney);\n        totalEle.innerText = WNumbHelper.GetFrNumber(sumdiscount + shipFee);\n      });\n    } //uploadCart(txtDiscountCode.value);\n\n  } else {\n    if (!!vnLocationCartDetailId) {\n      vnLocationCartDetailId.value = \"\";\n    }\n  }\n}"]}