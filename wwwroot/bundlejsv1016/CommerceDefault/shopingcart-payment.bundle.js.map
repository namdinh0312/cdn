{"version":3,"sources":["shoppingcart-payment.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shopingcart-payment.bundle.js","sourcesContent":["\"use strict\";\r\nvar myList, txtPhone, txtAddress, txtId, txtFullName, phoneNumberCleave, btnReloadShopingCartcartDetail, txtCode, txtDiscountcartDetail;\r\nvar txtDiscountCode, btnSubmitLoadDiscountCode, frmShipInfo;\r\nvar btnSearchWard, txtVnLocationName, txtVnLocationId, spanDataShipAddress;\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\",\r\n    function () {\r\n        initPayment();\r\n        loadCleave();\r\n        loadAutoComplete();\r\n        loadLocationAutoComplete();\r\n        btnReloadShopingCartcartDetail = document.getElementById(\"btnReloadShopingCartcartDetail\");\r\n        btnReloadShopingCartcartDetail.click();\r\n        //frmShipInfo = document.querySelector(\"#frmShipInfo button\");\r\n        //if (!!frmShipInfo) {\r\n        //    frmShipInfo.addEventListener(\"click\", googleEcommerceChecking);\r\n        //}\r\n        updateRealAddress();\r\n    });\r\n\r\n//function googleEcommerceChecking() {\r\n//    var productItemElements = document.querySelectorAll(\"._id-cartcartDetail li\");\r\n\r\n//    for (var i = 0; i < productItemElements.length; i++) {\r\n//        var productId = productItemElements[i].querySelector(\"[data-product-id]\").dataset.productId;\r\n//        var productName = productItemElements[i].querySelector(\"[data-product-name]\").dataset.productName;\r\n//        var productVariant = productItemElements[i].querySelector(\"[data-product-class-name]\").dataset.productClassName;\r\n//        var productQuantity = productItemElements[i].querySelector(\"[data-quantity]\").dataset.quantity;\r\n//        var productPrice = productItemElements[i].querySelector(\"[data-price]\").dataset.price; \r\n//        EnhancedEcommerce.AddProduct(productId, productName, productVariant, '', '', productPrice, productQuantity);\r\n//    }\r\n//}\r\n\r\nfunction showAnimation() {\r\n    debugger;\r\n}\r\n\r\nfunction initPayment() {\r\n    myList = document.getElementById(\"mylist\");\r\n    txtPhone = document.getElementById(\"OrderViewModel_PhoneNumber\");\r\n    txtAddress = document.getElementById(\"OrderViewModel_Address\");\r\n    txtAddress.addEventListener(\"keyup\", function (e) {\r\n        updateRealAddress();\r\n    });\r\n    txtId = document.getElementById(\"OrderViewModel_ShippingAddressId\");\r\n    txtFullName = document.getElementById(\"OrderViewModel_FullName\");\r\n    btnSearchWard = document.getElementById(\"btnSearchWard\");\r\n    txtVnLocationName = document.getElementById(\"OrderViewModel_VnLocationName\");\r\n    txtVnLocationId = document.getElementById(\"OrderViewModel_VnLocationId\");\r\n\r\n    txtVnLocationName.addEventListener(\"keyup\", function (e) {\r\n        updateVnLocation();\r\n        updateRealAddress();\r\n    });\r\n\r\n    txtDiscountCode = document.getElementById(\"OrderViewModel_DiscountCode\");\r\n    spanDataShipAddress = document.querySelector(\"[data-ship-address]\");\r\n    txtDiscountCode.addEventListener(\"keyup\", function (e) {\r\n        uploadCart(e.target.value);\r\n\r\n    });\r\n}\r\n\r\nfunction processListItemShopingCartcartDetail() {\r\n\r\n}\r\n\r\nfunction uploadCart(codeStr) {\r\n\r\n    if (codeStr.length !== 8) {\r\n        return;\r\n    }\r\n\r\n    txtCode = document.getElementById(\"txtCode\");\r\n    txtDiscountcartDetail = document.getElementById(\"txtDiscountcartDetail\");\r\n    txtCode.value = codeStr;\r\n    txtDiscountcartDetail.value = codeStr;\r\n\r\n    btnReloadShopingCartcartDetail = document.getElementById(\"btnReloadShopingCartcartDetail\");\r\n    btnReloadShopingCartcartDetail.click();\r\n\r\n    btnSubmitLoadDiscountCode = document.getElementById(\"btnSubmitLoadDiscountCode\");\r\n    btnSubmitLoadDiscountCode.click();\r\n\r\n}\r\n\r\nfunction loadCleave() {\r\n    var mobileElement = document.getElementById('OrderViewModel_PhoneNumber');\r\n\r\n    phoneNumberCleave = new Cleave(mobileElement, {\r\n        numericOnly: true,\r\n        delimiters: [' ', ' ', ' '],\r\n        //prefix: '+84',\r\n        blocks: [4, 3, 5]\r\n    });\r\n}\r\n\r\nfunction loadAutoComplete() {\r\n    new Awesomplete('#OrderViewModel_FullName', {\r\n        filter: function (text, input) {\r\n            return Awesomplete.FILTER_CONTAINS(text, input.match(/[^\\|]*$/)[0]);\r\n        },\r\n\r\n        item: function (text, input) {\r\n            return Awesomplete.ITEM(text, input.match(/[^\\|]*$/)[0]);\r\n        },\r\n\r\n        replace: function (text) {\r\n            var before = this.input.value.match(/^.+\\|\\s*|/)[0];\r\n            this.input.value = before + text.value.split('=')[1];\r\n        }\r\n    });\r\n\r\n    document.getElementById('OrderViewModel_FullName').addEventListener(\"awesomplete-selectcomplete\", function (event) {\r\n        var id = event.text.value.split(\"=\")[0];\r\n        event.target.value = event.text.value.split(\"=\")[1];\r\n        for (var i = 0; i < myList.options.length; i++) {\r\n            var opt = myList.options[i];\r\n            if (opt.id === id) {\r\n                txtPhone.value = opt.dataset.phone;\r\n                txtAddress.value = opt.dataset.address;\r\n                txtId.value = id;\r\n                console.log('autocomplet');\r\n                loadCleave();\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    document.getElementById('OrderViewModel_FullName').addEventListener(\"change\", function (event) {\r\n        console.log(\"change\");\r\n        loadCleave();\r\n    });\r\n\r\n}\r\n\r\nfunction updateRealAddress() {\r\n    spanDataShipAddress.innerHTML = !!txtAddress.value\r\n        ? (txtAddress.value + \", \" + txtVnLocationName.value).trim()\r\n        : txtVnLocationName.value;\r\n}\r\n\r\nfunction loadLocationAutoComplete() {\r\n\r\n    $('#OrderViewModel_VnLocationName').autocomplete({\r\n        appendTo: \"#suggestListLocationContainer\",\r\n        serviceUrl: '/shopingcart/searchlocationcomplete',\r\n        //lookup: theData,\r\n        deferRequestBy: 100,\r\n        minChars: 3,\r\n        noCache: true,\r\n        onSelect: function (suggestion) {\r\n            updateRealAddress(suggestion);\r\n            txtVnLocationId.value = suggestion.data.id;\r\n            updateVnLocation();\r\n        },\r\n        showNoSuggestionNotice: true,\r\n        noSuggestionNotice: 'Không tìm thấy địa chỉ',\r\n        formatResult: function (suggestion, currentValue) {\r\n            return \"<div class='padding-5  _cursor-poiter' level=\" + suggestion.data.level + \" data-vnlocation-id='\" + suggestion.data.id + \"'>\" +\r\n                suggestion.value +\r\n                \"</div>\";\r\n        },\r\n        lookupFilter: function (suggestion, originalQuery, queryLowerCase) {\r\n            var re = new RegExp('\\\\b' + $.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');\r\n            return re.test(suggestion.value);\r\n        },\r\n        onSearchStart: function (query) {\r\n            Site.AddClassElement(btnSearchWard, \"active\");\r\n            txtVnLocationId.value = \"\";\r\n        },\r\n        onSearchComplete: function (query, suggestions) {\r\n            Site.RemoveClassElement(btnSearchWard, \"active\");\r\n        }\r\n    });\r\n}\r\n\r\nfunction updateVnLocation() {\r\n    var curentVnLocationId = txtVnLocationId.value;\r\n    var vnLocationCartDetailId = document.querySelector(\"#frmLazyLoadShopingCartcartDetail [name=vnLocationId]\");\r\n    var messageElement = document.querySelector(\"#frmLazyLoadShopingCartcartDetail [data-order-message]\");\r\n\r\n    if (!!curentVnLocationId) {\r\n        if (curentVnLocationId != vnLocationCartDetailId.value) {\r\n            vnLocationCartDetailId.value = curentVnLocationId;\r\n            var totalDetailElement = document.querySelector(\"[data-weight]\");\r\n\r\n            AjaxRequest.SendRequestGetJson(\"POST\",\r\n                \"shopingcart/getshipfree\",\r\n                {\r\n                    \"vnLocationId\": curentVnLocationId,\r\n                    \"sumdiscount\": totalDetailElement.dataset.sumReal,\r\n                    \"totalWeight\": totalDetailElement.dataset.weight\r\n                },\r\n                function (e, v) {\r\n                    var responseObject = JSON.parse(e);\r\n                    var messageEle = document.getElementById(\"message\");\r\n                    var suggestMessageEle = document.getElementById(\"suggestMessage\");\r\n                    var delShipPriceEle = document.getElementById(\"delShipPrice\");\r\n                    var shipPriceEle = document.getElementById(\"shipPrice\");\r\n                    var delTotalEle = document.getElementById(\"delTotal\");\r\n                    var totalEle = document.getElementById(\"total\");\r\n                 \r\n                    messageEle.innerText = responseObject.message;\r\n                    suggestMessageEle.innerText = responseObject.suggestMessage;\r\n\r\n                    var shipFee = responseObject.normalShipPrice - ((responseObject.maxSupportNormalShipPrice === 0 ? responseObject.normalShipPrice : responseObject.maxSupportNormalShipPrice) * responseObject.shipDiscountPercent / 100);\r\n                    delShipPriceEle.parentNode.classList.add(responseObject.shipDiscountPercent > 0 ? \"visible\" : \"hidden\");\r\n\r\n                    delShipPriceEle.innerText = WNumbHelper.GetFrNumber(responseObject.normalShipPrice);\r\n                    shipPriceEle.innerText = WNumbHelper.GetFrNumber(shipFee);\r\n\r\n\r\n                    var sumdiscount = +totalDetailElement.dataset.sumReal;\r\n                    var summoney = +totalDetailElement.dataset.sumTemp;\r\n                    delTotalEle.parentNode.classList.add((responseObject.shipDiscountPercent > 0 || sumdiscount !== summoney) ? \"visible\" : \"hidden\");\r\n\r\n                    delTotalEle.innerText = WNumbHelper.GetFrNumber(responseObject.normalShipPrice + summoney);\r\n                    totalEle.innerText = WNumbHelper.GetFrNumber(sumdiscount+shipFee);\r\n\r\n                });\r\n        }\r\n        //uploadCart(txtDiscountCode.value);\r\n    } else {\r\n        if (!!vnLocationCartDetailId) {\r\n            vnLocationCartDetailId.value = \"\";\r\n        }\r\n    }\r\n}"]}